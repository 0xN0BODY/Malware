import io
from x64dbgpy.pluginsdk import *


BREAK_RVA = 0x73C3
IMPORT_LIST_RVA = 0x11298
NUM_IMPORT_FUNCS = 0x2F8 // 4


Run()

base_addr = BaseFromAddr(GetEIP())

break_addr = base_addr + BREAK_RVA
SetBreakpoint(break_addr)

Run()

DeleteBreakpoint(break_addr)

with io.open('ida_import.txt', 'wb') as f:

    fnc_name_buf = ctypes.create_string_buffer(x64dbg.MAX_LABEL_SIZE)

    fnc_addr_rva = IMPORT_LIST_RVA

    for _ in range(NUM_IMPORT_FUNCS):

        fnc_addr = ReadDword(base_addr + fnc_addr_rva)
        if x64dbg.DbgGetLabelAt(fnc_addr, x64dbg.SEG_DEFAULT, fnc_name_buf):
            f.write(b'%08X\t%s\r\n' % (fnc_addr_rva, fnc_name_buf.value))

        fnc_addr_rva += 4
